---
layout: post
title:  "UoI-NMFcluster: A Robust Nonnegative Matrix Factorization Algorithm for Improved Parts-Based Decomposition and Reconstruction of Noisy Data (Ubaru et al., 2017)"
date:   2020-05-25 01:07:13 +0900
categories: paper
---
[論文](https://ieeexplore.ieee.org/abstract/document/8260640)
# TL;DR
データがノイジーな場合にNMFで基底が求まらない可能性がある．
ブートストラップで基底を沢山作って安定した基底を見つけてUoIで再構成するというお話．

# 背景
NMFのuniquenessとか議論されているけど，大抵入力データに強い仮定を置いてたり，その仮定を確かめるのが難しかったりする．
データによっては仮定を満たせない場合がある．
データにノイズが載っている場合は基底を安定して推定できない．

# 手法
Union of Intersections (UoI)は最近出てきたフレームワーク．
特徴量推定から特徴量選択を分けようというコンセプトで，ブートストラップを使って安定した特徴量を推定してからそのパラメタを推定する．

UoI-NMFのアルゴリズム

a）基底の学習

ブートストラップサンプルを作り，それぞれについて異なる基底数kを用いてNMFでHとWを推定する．
異なるブートストラップサンプルからの似ている基底は安定した物とみなせ，逆にブートストラップサンプルによって異なる基底は空間の中でランダムに散らばっていると考えられる．
この安定した基底を見つけるのにDBSCANというアルゴリズムを用いる．
DBSCANではノイズのような基底は取り除き，基底が密に集まったところを基底として抽出する．
そのクラスタの中心を基底とする．
基底数kはdissimilarity measureというのを使って計算している．
こうして基底Hが求まる．

b）基底の選択と重みの推定

それぞれのブートストラップサンプルについて重みWを計算する（NNLSやnonnegative LASSO regression使って）．
そしてintersection of the supportを行ごとに計算して（？重みの共通部分をとることでスパースにする？）インデックス行列Widxを得る．
次に実際の重みを計算する．
別のブートストラップサンプルを作り，Widxに基づいたWを計算する．
ブートストラップサンプルごとのWを平均することで最終的な重み行列を得る．
以下が全体のアルゴリズム．

![algorithm](/assets/2020-05-25.png)

データのseparabilityは解の一意性に必要だが，確かめるのが難しく，データがノイジーな場合に満たさないことが多い．
ブートストラップによって，vertices近くに基底が密に集まると期待できる．

# 結果
ノイズが乗った状況でも綺麗に基底を取り出せた．
重みもスパースだった．
MNISTで複数の数字が入った場合も1や7などは似ているが綺麗に別の基底として取り出せた．

マウスのECoGデータを分解した結果では，基底は脳の位置に対応しているものが多かった．
また，電気生理のデータでも実験していた．

# 結論
この論文では
(i)基底学習と重み推定を切り離した，
(ii)ブートストラップサンプルからの基底をクラスタリングして基底を抽出した，
(iii)重みの推定にはUoI-frameworkを用いた．
ノイズが多い場合でも安定した基底を取り出せるようになった．

スパースコーディングなどの分解アルゴリズムにもこのテクニックは使えると思われる．
